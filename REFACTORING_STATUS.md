# –°—Ç–∞—Ç—É—Å —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥—É

## ‚úÖ –í–∏–∫–æ–Ω–∞–Ω–æ

### 1. –°—Ç–≤–æ—Ä–µ–Ω–æ –º–æ–¥—É–ª—å–Ω—É —Å—Ç—Ä—É–∫—Ç—É—Ä—É
- ‚úÖ `app/core/` - —è–¥—Ä–æ —Å–∏—Å—Ç–µ–º–∏ (config, database, security, middleware)
- ‚úÖ `app/modules/auth/` - –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—è —Ç–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—è
- ‚úÖ `app/modules/communications/` - unified inbox (–∑–∞–≥–ª—É—à–∫–∏)
- ‚úÖ `app/modules/crm/` - CRM —Ñ—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª (–∑–∞–≥–ª—É—à–∫–∏)
- ‚úÖ `app/modules/finance/` - —Ñ—ñ–Ω–∞–Ω—Å–∏ (–∑–∞–≥–ª—É—à–∫–∏)
- ‚úÖ `app/modules/analytics/` - –∞–Ω–∞–ª—ñ—Ç–∏–∫–∞ (–∑–∞–≥–ª—É—à–∫–∏)
- ‚úÖ `app/main_refactored.py` - –Ω–æ–≤–∏–π entry point

### 2. Core –º–æ–¥—É–ª—å
- ‚úÖ `core/config.py` - —Ü–µ–Ω—Ç—Ä–∞–ª—ñ–∑–æ–≤–∞–Ω–∞ –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—è (Pydantic Settings)
- ‚úÖ `core/database.py` - –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è –¥–æ –ë–î, —Å–µ—Å—ñ—ó
- ‚úÖ `core/security.py` - JWT, —Ö–µ—à—É–≤–∞–Ω–Ω—è –ø–∞—Ä–æ–ª—ñ–≤
- ‚úÖ `core/middleware.py` - CORS middleware

### 3. Auth –º–æ–¥—É–ª—å
- ‚úÖ `modules/auth/router.py` - –±–∞–∑–æ–≤—ñ auth endpoints
- ‚úÖ `modules/auth/dependencies.py` - get_current_user_db, require_admin

## üîÑ –í –ø—Ä–æ—Ü–µ—Å—ñ

### –ü–µ—Ä–µ–Ω–µ—Å–µ–Ω–Ω—è –∫–æ–¥—É –∑ –º–æ–Ω–æ–ª—ñ—Ç—É
- [ ] –ü–µ—Ä–µ–Ω–µ—Å—Ç–∏ –≤—Å—ñ auth routes –∑ `routes.py` –≤ `modules/auth/router.py`
- [ ] –ü–µ—Ä–µ–Ω–µ—Å—Ç–∏ client/KP routes –≤ `modules/crm/router.py`
- [ ] –ü–µ—Ä–µ–Ω–µ—Å—Ç–∏ email/telegram —Å–µ—Ä–≤—ñ—Å–∏ –≤ `modules/communications/`
- [ ] –†–æ–∑–±–∏—Ç–∏ `models.py` –ø–æ –º–æ–¥—É–ª—è—Ö
- [ ] –†–æ–∑–±–∏—Ç–∏ `schema.py` –ø–æ –º–æ–¥—É–ª—è—Ö
- [ ] –†–æ–∑–±–∏—Ç–∏ `crud.py` –ø–æ –º–æ–¥—É–ª—è—Ö

## üìã TODO

### –ï—Ç–∞–ø 1: –ú—ñ–≥—Ä–∞—Ü—ñ—è routes
- [ ] –ü–µ—Ä–µ–Ω–µ—Å—Ç–∏ `/auth/*` endpoints
- [ ] –ü–µ—Ä–µ–Ω–µ—Å—Ç–∏ `/clients/*` endpoints
- [ ] –ü–µ—Ä–µ–Ω–µ—Å—Ç–∏ `/kp/*` endpoints
- [ ] –ü–µ—Ä–µ–Ω–µ—Å—Ç–∏ `/items/*` endpoints
- [ ] –ü–µ—Ä–µ–Ω–µ—Å—Ç–∏ `/templates/*` endpoints

### –ï—Ç–∞–ø 2: –ú—ñ–≥—Ä–∞—Ü—ñ—è –º–æ–¥–µ–ª–µ–π
- [ ] –°—Ç–≤–æ—Ä–∏—Ç–∏ `modules/auth/models.py` (User, PasswordResetCode)
- [ ] –°—Ç–≤–æ—Ä–∏—Ç–∏ `modules/crm/models.py` (Client, KP, KPItem, —Ç–æ—â–æ)
- [ ] –°—Ç–≤–æ—Ä–∏—Ç–∏ `modules/communications/models.py` (TelegramAccount, —Ç–æ—â–æ)

### –ï—Ç–∞–ø 3: –ú—ñ–≥—Ä–∞—Ü—ñ—è —Å—Ö–µ–º
- [ ] –°—Ç–≤–æ—Ä–∏—Ç–∏ `modules/auth/schemas.py`
- [ ] –°—Ç–≤–æ—Ä–∏—Ç–∏ `modules/crm/schemas.py`
- [ ] –°—Ç–≤–æ—Ä–∏—Ç–∏ `modules/communications/schemas.py`

### –ï—Ç–∞–ø 4: –ú—ñ–≥—Ä–∞—Ü—ñ—è CRUD
- [ ] –°—Ç–≤–æ—Ä–∏—Ç–∏ `modules/auth/crud.py`
- [ ] –°—Ç–≤–æ—Ä–∏—Ç–∏ `modules/crm/crud.py`
- [ ] –°—Ç–≤–æ—Ä–∏—Ç–∏ `modules/communications/crud.py`

### –ï—Ç–∞–ø 5: –¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è
- [ ] –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ —â–æ –≤—Å—ñ endpoints –ø—Ä–∞—Ü—é—é—Ç—å
- [ ] –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ —â–æ auth –ø—Ä–∞—Ü—é—î
- [ ] –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ —â–æ –º–æ–¥—É–ª—ñ –Ω–µ–∑–∞–ª–µ–∂–Ω—ñ

### –ï—Ç–∞–ø 6: –û—á–∏—â–µ–Ω–Ω—è
- [ ] –í–∏–¥–∞–ª–∏—Ç–∏ —Å—Ç–∞—Ä–∏–π `routes.py`
- [ ] –ü–µ—Ä–µ–π–º–µ–Ω—É–≤–∞—Ç–∏ `main_refactored.py` ‚Üí `main.py`
- [ ] –û–Ω–æ–≤–∏—Ç–∏ Dockerfile

## üéØ –ù–∞—Å—Ç—É–ø–Ω—ñ –∫—Ä–æ–∫–∏

1. **–¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è –±–∞–∑–æ–≤–æ—ó —Å—Ç—Ä—É–∫—Ç—É—Ä–∏:**
   ```bash
   uvicorn app.main_refactored:app --reload
   ```

2. **–ü–æ—á–∞—Ç–∏ –º—ñ–≥—Ä–∞—Ü—ñ—é –∑ auth –º–æ–¥—É–ª—è** (–Ω–∞–π–ø—Ä–æ—Å—Ç—ñ—à–∏–π):
   - –ü–µ—Ä–µ–Ω–µ—Å—Ç–∏ –≤—Å—ñ auth routes
   - –ü–µ—Ä–µ–Ω–µ—Å—Ç–∏ User –º–æ–¥–µ–ª—å
   - –ü–µ—Ä–µ–Ω–µ—Å—Ç–∏ auth schemas
   - –ü–µ—Ä–µ–Ω–µ—Å—Ç–∏ crud_user

3. **–ü–æ—Ç—ñ–º CRM –º–æ–¥—É–ª—å** (–Ω–∞–π–±—ñ–ª—å—à–∏–π):
   - –ü–µ—Ä–µ–Ω–µ—Å—Ç–∏ client/KP routes
   - –ü–µ—Ä–µ–Ω–µ—Å—Ç–∏ –º–æ–¥–µ–ª—ñ
   - –ü–µ—Ä–µ–Ω–µ—Å—Ç–∏ —Å—Ö–µ–º–∏
   - –ü–µ—Ä–µ–Ω–µ—Å—Ç–∏ CRUD

## üìù –ü—Ä–∏–º—ñ—Ç–∫–∏

- –°—Ç–∞—Ä–∏–π `main.py` –∑–∞–ª–∏—à–∞—î—Ç—å—Å—è –¥–ª—è —Å—É–º—ñ—Å–Ω–æ—Å—Ç—ñ
- –°—Ç–∞—Ä–∏–π `routes.py` –∑–∞–ª–∏—à–∞—î—Ç—å—Å—è –ø–æ–∫–∏ –Ω–µ –∑–∞–≤–µ—Ä—à–µ–Ω–æ –º—ñ–≥—Ä–∞—Ü—ñ—é
- –ú–æ–∂–Ω–∞ –∑–∞–ø—É—Å–∫–∞—Ç–∏ –æ–±–∏–¥–≤—ñ –≤–µ—Ä—Å—ñ—ó –ø–∞—Ä–∞–ª–µ–ª—å–Ω–æ –¥–ª—è —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è

