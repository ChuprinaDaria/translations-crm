#!/bin/bash
# –°–∫—Ä–∏–ø—Ç –¥–ª—è –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –º—ñ–≥—Ä–∞—Ü—ñ—ó –≤–∏–ø—Ä–∞–≤–ª–µ–Ω–Ω—è —Ç–∏–ø—É api_id

echo "=========================================="
echo "–í–∏–ø—Ä–∞–≤–ª–µ–Ω–Ω—è —Ç–∏–ø—É –∫–æ–ª–æ–Ω–∫–∏ api_id"
echo "=========================================="

# –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —á–∏ –∑–∞–ø—É—â–µ–Ω–∏–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä
if ! docker ps | grep -q crm_translations_backend; then
    echo "‚ùå –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä crm_translations_backend –Ω–µ –∑–∞–ø—É—â–µ–Ω–∏–π!"
    echo "–ó–∞–ø—É—Å—Ç—ñ—Ç—å: docker-compose up -d"
    exit 1
fi

echo "üì¶ –ó–∞–ø—É—Å–∫ –º—ñ–≥—Ä–∞—Ü—ñ—ó –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ñ..."
docker exec crm_translations_backend python run_migration.py

if [ $? -eq 0 ]; then
    echo ""
    echo "‚úÖ –ú—ñ–≥—Ä–∞—Ü—ñ—è —É—Å–ø—ñ—à–Ω–æ –≤–∏–∫–æ–Ω–∞–Ω–∞!"
    echo ""
    echo "–¢–µ–ø–µ—Ä –º–æ–∂–Ω–∞ —Å–ø—Ä–æ–±—É–≤–∞—Ç–∏ –∑–±–µ—Ä–µ–≥—Ç–∏ Telegram –∞–∫–∞—É–Ω—Ç –∑–Ω–æ–≤—É."
else
    echo ""
    echo "‚ùå –ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ –≤–∏–∫–æ–Ω–∞–Ω–Ω—ñ –º—ñ–≥—Ä–∞—Ü—ñ—ó"
    echo "–ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ –ª–æ–≥–∏: docker logs crm_translations_backend"
    exit 1
fi

